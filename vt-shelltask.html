<link rel="import" href="./vt-model-element.html">
<link rel="import" href="../shy-injecter/shy-injecter.html">

<!-- events: statusChanged (enqueued, canceled, working, dropped, finished) -->
<polymer-element name="vt-shelltask" extends="vt-model-element" attributes="command status params" status="enqueued">
  <template>
    <shy-injecter id="injecter"></shy-injecter>
    <div on-click="{{cycleStatus}}">
      <link rel="stylesheet" href="vt-shelltask.css"/>
      #{{elt_id}} - {{command}} - {{injected}}
    </div>
  </template>
  <script>
    Polymer('vt-shelltask',{
      command : "ls",
      status: "unknown",
      injected : "",
      params : {},
      paramsChanged: function(){
        this.injectParams();
      },
      commandChanged: function(){
        this.injectParams();
      },
      dataChanged : function(){
        this.command = this.data.command;
      },
      cycleStatus : function(){
        this.setAttribute('status', (this.status == 'canceled') ? 'enqueued' : 'canceled' );
      },
      injectParams : function(){
        var injecter = this.$.injecter;
        var command = this.command ? this.command : '';
        if(injecter){
          injecter.input = command;
          injecter.params = this.params;
          command = injecter.getInjected();
        }
        this.injected = command;
      }
    });
  </script>
</polymer-element>